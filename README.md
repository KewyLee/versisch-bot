# Telegram Bot для Страховых Форм

Этот проект представляет собой Telegram бота, который помогает пользователям заполнять страховые формы и генерировать PDF-документы на основе введенных данных.

## Основные функции

- Веб-интерфейс для заполнения страховых форм
- Генерация PDF-документов на основе данных формы
- Отправка заполненных форм администратору через Telegram
- Поддержка подписи пользователя
- Автоматический разбор и форматирование адресов
- Транслитерация кириллических символов для совместимости с PDF

## Технологии

- Node.js и Express для серверной части
- Telegraf для работы с Telegram API
- pdf-lib для генерации PDF-документов
- HTML, CSS и JavaScript для веб-интерфейса

## Структура проекта

```
project-folder/
├── index.js           # Основной файл сервера и бота
├── server.js          # Точка входа для Heroku
├── Procfile           # Конфигурация для Heroku
├── BIG_Vermittlervollmacht.pdf  # Шаблон PDF-документа
├── utils/
│   └── pdfGenerator.js  # Модуль для генерации PDF
├── public/
│   ├── index.html       # Основная страница
│   ├── styles.css       # Стили основной страницы
│   └── app.js           # JavaScript основной страницы
└── output/              # Директория для сгенерированных PDF
```

## Файлы в директории public

- **index.html** - Основная страница с формой для ввода данных страхования
- **styles.css** - Стили для основной страницы
- **app.js** - JavaScript для обработки формы и отправки данных на сервер

## Установка и запуск

1. Клонировать репозиторий:
   ```
   git clone https://github.com/KewyLee/versisch-bot.git
   cd versisch-bot
   ```

2. Установить зависимости:
   ```
   npm install
   ```

3. Создать файл `.env` с переменными окружения:
   ```
   BOT_TOKEN=your_telegram_bot_token
   ADMIN_CHAT_ID=your_admin_chat_id
   APP_URL=https://your-app-url.herokuapp.com
   ```

4. Запустить приложение:
   ```
   npm start
   ```

## Деплой на Heroku

1. Создать приложение на Heroku:
   ```
   heroku create
   ```

2. Установить переменные окружения:
   ```
   heroku config:set BOT_TOKEN=your_telegram_bot_token
   heroku config:set ADMIN_CHAT_ID=your_admin_chat_id
   heroku config:set APP_URL=https://your-app-url.herokuapp.com
   ```

3. Деплой приложения:
   ```
   git push heroku main
   ```

## Особенности работы с PDF

- Для генерации PDF используется библиотека pdf-lib
- Координаты полей в PDF установлены вручную на основе анализа шаблона
- Кириллические символы автоматически транслитерируются для совместимости с PDF
- На Heroku PDF-файлы сохраняются во временную директорию /tmp

## Разработка

При разработке новых функций следуйте этим рекомендациям:

1. Используйте ESLint для поддержания качества кода
2. Добавляйте комментарии к сложным частям кода
3. Тестируйте изменения локально перед деплоем на Heroku
4. Обновляйте документацию при добавлении новых функций

## Лицензия

MIT 